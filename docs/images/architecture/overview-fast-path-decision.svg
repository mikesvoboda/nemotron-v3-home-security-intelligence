<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 450" width="700" height="450">
  <defs>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#60A5FA"/>
      <stop offset="100%" style="stop-color:#3B82F6"/>
    </linearGradient>
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#34D399"/>
      <stop offset="100%" style="stop-color:#10B981"/>
    </linearGradient>
    <linearGradient id="amberGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FBBF24"/>
      <stop offset="100%" style="stop-color:#F59E0B"/>
    </linearGradient>
    <linearGradient id="redGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#F87171"/>
      <stop offset="100%" style="stop-color:#EF4444"/>
    </linearGradient>
    <linearGradient id="purpleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#A78BFA"/>
      <stop offset="100%" style="stop-color:#8B5CF6"/>
    </linearGradient>
    <marker id="arrowBlack" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#374151"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#EF4444"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#10B981"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="700" height="450" fill="#F9FAFB"/>

  <!-- Title -->
  <text x="350" y="35" font-family="system-ui, -apple-system, sans-serif" font-size="22" font-weight="600" fill="#1F2937" text-anchor="middle">Fast Path vs Normal Batching</text>
  <text x="350" y="55" font-family="system-ui, sans-serif" font-size="12" fill="#6B7280" text-anchor="middle">Decision logic for immediate vs batched LLM analysis</text>

  <!-- Detection Input -->
  <g transform="translate(300, 80)">
    <rect x="0" y="0" width="100" height="50" rx="8" fill="url(#blueGrad)" filter="url(#shadow)"/>
    <text x="50" y="30" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">Detection</text>
  </g>

  <!-- Arrow from Detection to Decision -->
  <line x1="350" y1="130" x2="350" y2="160" stroke="#374151" stroke-width="2" marker-end="url(#arrowBlack)"/>

  <!-- Decision Diamond -->
  <g transform="translate(250, 165)">
    <polygon points="100,0 200,60 100,120 0,60" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2" filter="url(#shadow)"/>
    <text x="100" y="50" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#92400E" text-anchor="middle">Confidence > 90%</text>
    <text x="100" y="68" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#92400E" text-anchor="middle">AND</text>
    <text x="100" y="86" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#92400E" text-anchor="middle">type = person?</text>
  </g>

  <!-- Yes Label -->
  <text x="480" y="230" font-family="system-ui, sans-serif" font-size="14" font-weight="700" fill="#EF4444">Yes</text>

  <!-- Arrow from Decision to Fast Path (right) -->
  <line x1="450" y1="225" x2="520" y2="225" stroke="#EF4444" stroke-width="2" marker-end="url(#arrowRed)"/>

  <!-- Fast Path Box -->
  <g transform="translate(530, 185)">
    <rect x="0" y="0" width="140" height="80" rx="10" fill="url(#redGrad)" filter="url(#shadow)"/>
    <text x="70" y="30" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="white" text-anchor="middle">Fast Path</text>
    <text x="70" y="50" font-family="system-ui, sans-serif" font-size="10" fill="#FEE2E2" text-anchor="middle">Immediate LLM</text>
    <text x="70" y="65" font-family="system-ui, sans-serif" font-size="10" fill="#FEE2E2" text-anchor="middle">analysis</text>
  </g>

  <!-- Arrow from Fast Path to Fast Path Event -->
  <line x1="600" y1="265" x2="600" y2="300" stroke="#EF4444" stroke-width="2" marker-end="url(#arrowRed)"/>

  <!-- Fast Path Event -->
  <g transform="translate(530, 305)">
    <rect x="0" y="0" width="140" height="60" rx="8" fill="url(#amberGrad)" filter="url(#shadow)"/>
    <text x="70" y="25" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">Event created</text>
    <text x="70" y="45" font-family="monospace" font-size="10" fill="#FEF3C7" text-anchor="middle">is_fast_path=true</text>
  </g>

  <!-- No Label -->
  <text x="340" y="310" font-family="system-ui, sans-serif" font-size="14" font-weight="700" fill="#10B981">No</text>

  <!-- Arrow from Decision to Normal Path (down) -->
  <line x1="350" y1="285" x2="350" y2="315" stroke="#10B981" stroke-width="2" marker-end="url(#arrowGreen)"/>

  <!-- Normal Path Box -->
  <g transform="translate(280, 320)">
    <rect x="0" y="0" width="140" height="80" rx="10" fill="url(#greenGrad)" filter="url(#shadow)"/>
    <text x="70" y="30" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="white" text-anchor="middle">Normal Path</text>
    <text x="70" y="50" font-family="system-ui, sans-serif" font-size="10" fill="#D1FAE5" text-anchor="middle">Add to batch</text>
  </g>

  <!-- Arrow from Normal Path to Batch -->
  <line x1="280" y1="360" x2="200" y2="360" stroke="#10B981" stroke-width="2" marker-end="url(#arrowGreen)"/>

  <!-- Batch Accumulates -->
  <g transform="translate(30, 320)">
    <rect x="0" y="0" width="160" height="80" rx="8" fill="url(#purpleGrad)" filter="url(#shadow)"/>
    <text x="80" y="28" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">Batch accumulates</text>
    <text x="80" y="48" font-family="system-ui, sans-serif" font-size="9" fill="#E9D5FF" text-anchor="middle">90s window max</text>
    <text x="80" y="63" font-family="system-ui, sans-serif" font-size="9" fill="#E9D5FF" text-anchor="middle">30s idle timeout</text>
  </g>

  <!-- Arrow from Batch to Timeout Decision -->
  <line x1="110" y1="320" x2="110" y2="280" stroke="#374151" stroke-width="2" marker-end="url(#arrowBlack)"/>

  <!-- Timeout Decision Diamond -->
  <g transform="translate(50, 200)">
    <polygon points="60,0 120,40 60,80 0,40" fill="#E0E7FF" stroke="#6366F1" stroke-width="1.5"/>
    <text x="60" y="45" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#4338CA" text-anchor="middle">Timeout?</text>
  </g>

  <!-- Yes from Timeout -->
  <text x="55" y="195" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#6366F1">Yes</text>
  <line x1="50" y1="240" x2="20" y2="240" stroke="#6366F1" stroke-width="1.5"/>
  <line x1="20" y1="240" x2="20" y2="130" stroke="#6366F1" stroke-width="1.5"/>
  <line x1="20" y1="130" x2="85" y2="130" stroke="#6366F1" stroke-width="1.5" marker-end="url(#arrowBlack)"/>

  <!-- Normal Path Event -->
  <g transform="translate(90, 100)">
    <rect x="0" y="0" width="140" height="60" rx="8" fill="url(#amberGrad)" filter="url(#shadow)"/>
    <text x="70" y="25" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">Event created</text>
    <text x="70" y="45" font-family="monospace" font-size="10" fill="#FEF3C7" text-anchor="middle">is_fast_path=false</text>
  </g>

  <!-- Legend -->
  <g transform="translate(30, 410)">
    <rect x="0" y="0" width="640" height="35" rx="6" fill="white" stroke="#E5E7EB" stroke-width="1"/>
    <text x="15" y="23" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#374151">Legend:</text>

    <rect x="80" y="10" width="20" height="16" rx="3" fill="url(#redGrad)"/>
    <text x="108" y="23" font-family="system-ui, sans-serif" font-size="10" fill="#6B7280">Fast Path (~3-6s)</text>

    <rect x="230" y="10" width="20" height="16" rx="3" fill="url(#greenGrad)"/>
    <text x="258" y="23" font-family="system-ui, sans-serif" font-size="10" fill="#6B7280">Normal Path (30-120s)</text>

    <rect x="410" y="10" width="20" height="16" rx="3" fill="url(#amberGrad)"/>
    <text x="438" y="23" font-family="system-ui, sans-serif" font-size="10" fill="#6B7280">Event Output</text>

    <polygon points="565,18 580,10 595,18 580,26" fill="#FEF3C7" stroke="#F59E0B" stroke-width="1"/>
    <text x="603" y="23" font-family="system-ui, sans-serif" font-size="10" fill="#6B7280">Decision</text>
  </g>
</svg>
