<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500" width="900" height="500">
  <defs>
    <linearGradient id="blueGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2563EB;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="redGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#EF4444;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#DC2626;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="purpleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#A855F7;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#9333EA;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grayGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4B5563;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#374151;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="greenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="4" flood-color="#000" flood-opacity="0.4"/>
    </filter>
    <marker id="arrowGray" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6B7280"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#EF4444"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3B82F6"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="500" fill="#111827"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="20" font-weight="bold" fill="#F9FAFB">Dead-Letter Queue (DLQ) Architecture</text>

  <!-- Processing Queues Section -->
  <g transform="translate(30, 60)">
    <rect x="0" y="0" width="180" height="130" rx="10" fill="#1F2937" stroke="#374151" stroke-width="2"/>
    <text x="90" y="22" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="12" font-weight="600" fill="#9CA3AF">Processing Queues</text>

    <rect x="20" y="38" width="140" height="35" rx="6" fill="url(#blueGradient)" filter="url(#shadow)"/>
    <text x="90" y="60" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" font-weight="600" fill="white">detection_queue</text>

    <rect x="20" y="83" width="140" height="35" rx="6" fill="url(#blueGradient)" filter="url(#shadow)"/>
    <text x="90" y="105" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" font-weight="600" fill="white">analysis_queue</text>
  </g>

  <!-- Arrows to Workers -->
  <line x1="210" y1="95" x2="270" y2="95" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowGray)"/>
  <line x1="210" y1="140" x2="270" y2="140" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowGray)"/>

  <!-- Queue Workers Section -->
  <g transform="translate(280, 60)">
    <rect x="0" y="0" width="180" height="130" rx="10" fill="#1F2937" stroke="#374151" stroke-width="2"/>
    <text x="90" y="22" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="12" font-weight="600" fill="#9CA3AF">Queue Workers</text>

    <rect x="20" y="38" width="140" height="35" rx="6" fill="url(#grayGradient)" filter="url(#shadow)"/>
    <text x="90" y="56" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">DetectionQueue</text>
    <text x="90" y="68" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Worker</text>

    <rect x="20" y="83" width="140" height="35" rx="6" fill="url(#grayGradient)" filter="url(#shadow)"/>
    <text x="90" y="101" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">AnalysisQueue</text>
    <text x="90" y="113" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Worker</text>
  </g>

  <!-- Arrows to Retry Handler -->
  <line x1="460" y1="95" x2="520" y2="115" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowGray)"/>
  <line x1="460" y1="140" x2="520" y2="130" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowGray)"/>

  <!-- Retry Handler Section -->
  <g transform="translate(530, 80)">
    <rect x="0" y="0" width="160" height="80" rx="10" fill="#1F2937" stroke="#374151" stroke-width="2"/>
    <text x="80" y="22" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="12" font-weight="600" fill="#9CA3AF">Retry Layer</text>

    <rect x="15" y="35" width="130" height="35" rx="6" fill="url(#purpleGradient)" filter="url(#shadow)"/>
    <text x="80" y="53" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" font-weight="600" fill="white">RetryHandler</text>
    <text x="80" y="65" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#E9D5FF">max_retries=3</text>
  </g>

  <!-- Arrows to DLQs -->
  <line x1="610" y1="160" x2="610" y2="220" stroke="#EF4444" stroke-width="2"/>
  <line x1="610" y1="220" x2="290" y2="260" stroke="#EF4444" stroke-width="2" marker-end="url(#arrowRed)"/>
  <line x1="610" y1="220" x2="490" y2="260" stroke="#EF4444" stroke-width="2" marker-end="url(#arrowRed)"/>
  <text x="620" y="195" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#EF4444">Exhausted</text>

  <!-- Dead Letter Queues Section -->
  <g transform="translate(170, 270)">
    <rect x="0" y="0" width="370" height="90" rx="10" fill="#1F2937" stroke="#EF4444" stroke-width="2"/>
    <text x="185" y="22" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="12" font-weight="600" fill="#9CA3AF">Dead Letter Queues</text>

    <rect x="20" y="38" width="150" height="40" rx="6" fill="url(#redGradient)" filter="url(#shadow)"/>
    <text x="95" y="63" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" font-weight="600" fill="white">dlq:detection_queue</text>

    <rect x="200" y="38" width="150" height="40" rx="6" fill="url(#redGradient)" filter="url(#shadow)"/>
    <text x="275" y="63" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" font-weight="600" fill="white">dlq:analysis_queue</text>
  </g>

  <!-- DLQ Management API Section -->
  <g transform="translate(580, 230)">
    <rect x="0" y="0" width="280" height="170" rx="10" fill="#1F2937" stroke="#3B82F6" stroke-width="2"/>
    <text x="140" y="22" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="12" font-weight="600" fill="#9CA3AF">DLQ Management API</text>

    <rect x="80" y="35" width="120" height="30" rx="6" fill="url(#blueGradient)" filter="url(#shadow)"/>
    <text x="140" y="55" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="10" font-weight="600" fill="white">/api/dlq/*</text>

    <rect x="20" y="80" width="75" height="35" rx="6" fill="url(#grayGradient)" filter="url(#shadow)"/>
    <text x="57" y="96" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Inspect</text>
    <text x="57" y="108" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Jobs</text>

    <rect x="103" y="80" width="75" height="35" rx="6" fill="url(#greenGradient)" filter="url(#shadow)"/>
    <text x="140" y="96" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Requeue</text>
    <text x="140" y="108" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Jobs</text>

    <rect x="186" y="80" width="75" height="35" rx="6" fill="url(#redGradient)" filter="url(#shadow)"/>
    <text x="223" y="96" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Clear</text>
    <text x="223" y="108" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" font-weight="600" fill="white">Queue</text>

    <!-- Arrows from API to DLQs -->
    <text x="140" y="138" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#9CA3AF">Manual Operations</text>
  </g>

  <!-- Requeue arrows (dashed) back to processing queues -->
  <path d="M540 315 Q460 350 355 320 Q200 280 120 220" fill="none" stroke="#10B981" stroke-width="2" stroke-dasharray="6" marker-end="url(#arrowGray)"/>
  <text x="300" y="335" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#10B981">Manual Requeue</text>
  <text x="300" y="347" font-family="system-ui, -apple-system, sans-serif" font-size="9" fill="#10B981">Return to Processing</text>

  <!-- Legend -->
  <g transform="translate(30, 455)">
    <text x="0" y="0" font-family="system-ui, -apple-system, sans-serif" font-size="11" font-weight="600" fill="#9CA3AF">Legend:</text>
    <rect x="60" y="-12" width="16" height="16" rx="3" fill="url(#blueGradient)"/>
    <text x="82" y="1" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#9CA3AF">Processing Queue</text>
    <rect x="185" y="-12" width="16" height="16" rx="3" fill="url(#redGradient)"/>
    <text x="207" y="1" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#9CA3AF">Dead Letter Queue</text>
    <rect x="320" y="-12" width="16" height="16" rx="3" fill="url(#greenGradient)"/>
    <text x="342" y="1" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#9CA3AF">Recovery Action</text>
    <rect x="440" y="-12" width="16" height="16" rx="3" fill="url(#purpleGradient)"/>
    <text x="462" y="1" font-family="system-ui, -apple-system, sans-serif" font-size="10" fill="#9CA3AF">Retry Handler</text>
  </g>
</svg>
