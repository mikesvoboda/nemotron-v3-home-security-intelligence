# Custom DCGM Exporter Counters for Home Security Intelligence (NEM-4150)
#
# This file extends the default DCGM counters to include PCIe throughput metrics
# required by the GPU dashboard (hsi-gpu-metrics.json).
#
# Format:
#   DCGM_FIELD, prometheus_metric_type, help_message
#
# Reference: https://github.com/NVIDIA/dcgm-exporter/blob/main/etc/default-counters.csv
# Field IDs: https://docs.nvidia.com/datacenter/dcgm/latest/dcgm-api/dcgm-api-field-ids.html

# =============================================================================
# Clocks
# =============================================================================
DCGM_FI_DEV_SM_CLOCK,  gauge, SM clock frequency (in MHz).
DCGM_FI_DEV_MEM_CLOCK, gauge, Memory clock frequency (in MHz).

# =============================================================================
# Temperature
# =============================================================================
DCGM_FI_DEV_MEMORY_TEMP, gauge, Memory temperature (in C).
DCGM_FI_DEV_GPU_TEMP,    gauge, GPU temperature (in C).

# =============================================================================
# Power
# =============================================================================
DCGM_FI_DEV_POWER_USAGE,             gauge,   Power draw (in W).
DCGM_FI_DEV_TOTAL_ENERGY_CONSUMPTION, counter, Total energy consumption since boot (in mJ).

# =============================================================================
# PCIe Metrics (NEM-4150)
# =============================================================================
# PCIe replay counter for error detection
DCGM_FI_DEV_PCIE_REPLAY_COUNTER, counter, Total number of PCIe retries.

# PCIe throughput metrics - using profiling fields (PROF) which are the modern/recommended approach
# These replace the deprecated DCGM_FI_DEV_PCIE_TX/RX_THROUGHPUT fields
# Reference: https://github.com/NVIDIA/dcgm-exporter/issues/87
DCGM_FI_PROF_PCIE_TX_BYTES, gauge, The rate of data transmitted over the PCIe bus (bytes per second).
DCGM_FI_PROF_PCIE_RX_BYTES, gauge, The rate of data received over the PCIe bus (bytes per second).

# =============================================================================
# Utilization (Percent of time over past sample period)
# =============================================================================
DCGM_FI_DEV_GPU_UTIL,      gauge, GPU utilization (in %).
DCGM_FI_DEV_MEM_COPY_UTIL, gauge, Memory utilization (in %).
DCGM_FI_DEV_ENC_UTIL,      gauge, Encoder utilization (in %).
DCGM_FI_DEV_DEC_UTIL,      gauge, Decoder utilization (in %).

# =============================================================================
# Memory
# =============================================================================
DCGM_FI_DEV_FB_FREE, gauge, Framebuffer memory free (in MiB).
DCGM_FI_DEV_FB_USED, gauge, Framebuffer memory used (in MiB).

# =============================================================================
# ECC (Error Correcting Code)
# =============================================================================
DCGM_FI_DEV_ECC_SBE_VOL_TOTAL, counter, Total number of single-bit volatile ECC errors.
DCGM_FI_DEV_ECC_DBE_VOL_TOTAL, counter, Total number of double-bit volatile ECC errors.
DCGM_FI_DEV_ECC_SBE_AGG_TOTAL, counter, Total number of single-bit persistent ECC errors.
DCGM_FI_DEV_ECC_DBE_AGG_TOTAL, counter, Total number of double-bit persistent ECC errors.

# =============================================================================
# Retired Pages
# =============================================================================
DCGM_FI_DEV_RETIRED_SBE,     counter, Total number of retired pages due to single-bit errors.
DCGM_FI_DEV_RETIRED_DBE,     counter, Total number of retired pages due to double-bit errors.
DCGM_FI_DEV_RETIRED_PENDING, counter, Total number of pages pending retirement.

# =============================================================================
# NVLink (optional - may not be available on consumer GPUs)
# =============================================================================
# DCGM_FI_DEV_NVLINK_BANDWIDTH_TOTAL, counter, Total number of NVLink bandwidth counters for all lanes.

# =============================================================================
# XID Errors
# =============================================================================
DCGM_FI_DEV_XID_ERRORS, gauge, Value of the last XID error encountered.
