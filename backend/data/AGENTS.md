# Backend Data Directory - Agent Guide

## Purpose

The `backend/data/` directory stores runtime data for the home security intelligence system, including:

- Sample camera images for testing and development
- Log files (when using default log path)
- Generated thumbnails and other transient data

Note: The application uses PostgreSQL for the database, not SQLite. Database files are not stored in this directory.

## Directory Structure

```
backend/data/
├── .gitkeep              # Ensures directory exists in git
├── AGENTS.md             # This file
├── cameras/              # Sample camera image directories
│   ├── backyard/         # Backyard camera sample images
│   ├── driveway/         # Driveway camera sample images
│   └── front_door/       # Front door camera sample images
├── security.db           # SQLite database (legacy/development only)
├── thumbnails/           # Generated detection thumbnails (runtime)
└── logs/                 # Log files (runtime, not in git)
    └── security.log      # Rotating application log
```

## Sample Camera Directories

The `cameras/` subdirectory contains sample images for development and testing. These images are used by the file watcher service to test the AI pipeline.

### `cameras/backyard/`

Sample images simulating backyard camera uploads:

| File                          | Description                      |
| ----------------------------- | -------------------------------- |
| `capture_001.jpg` - `005.jpg` | Sequential test captures         |
| `alert_20251228_011355.jpg`   | Alert-triggered capture (sample) |

### `cameras/driveway/`

Sample images simulating driveway camera uploads:

| File                                | Description                       |
| ----------------------------------- | --------------------------------- |
| `capture_001.jpg` - `005.jpg`       | Sequential test captures          |
| `motion_$(date +%Y%m%d_%H%M%S).jpg` | Motion-triggered capture (sample) |

### `cameras/front_door/`

Sample images simulating front door camera uploads:

| File                          | Description                       |
| ----------------------------- | --------------------------------- |
| `capture_001.jpg` - `005.jpg` | Sequential test captures          |
| `new_capture_1766902398.jpg`  | Additional capture with timestamp |

## Runtime Files (Not in Git)

These files are created at runtime and are not tracked in version control:

### Thumbnail Files

**`thumbnails/`** - Generated detection thumbnails

- Format: `{detection_id}_thumb.jpg`
- Generated by thumbnail service during detection processing
- Includes bounding box overlays for detected objects
- Served via `/api/media/thumbnails/{filename}` endpoint

### Log Files

**`logs/security.log`** - Rotating application log file

- Configured via `LOG_FILE_PATH` setting
- Default max size: 10MB
- Default backup count: 7

## Configuration References

The data directory is referenced in configuration settings:

```python
# Database (PostgreSQL - external to this directory)
DATABASE_URL=postgresql+asyncpg://security:password@localhost:5432/security

# Default log file path
LOG_FILE_PATH=data/logs/security.log
```

## Usage Notes

### Development Testing

The sample images in `cameras/` can be used with the file watcher to simulate camera uploads:

```python
# File watcher monitors directories matching camera folder_path
# When new files appear, they are queued for detection
```

### Database Configuration

The application uses PostgreSQL (external to this directory):

```bash
# Example: PostgreSQL connection
DATABASE_URL=postgresql+asyncpg://security:password@localhost:5432/security
```

### Disk Space Considerations

- Log files rotate but can accumulate if not cleaned
- Thumbnails and detection images are stored based on service configuration

## Related Documentation

- `/backend/AGENTS.md` - Backend architecture overview
- `/backend/core/config.py` - Configuration settings
- `/backend/core/database.py` - Database initialization
- `/backend/services/file_watcher.py` - File watcher service
