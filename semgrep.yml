rules:
  - id: hardcoded-password
    patterns:
      - pattern-either:
          - pattern: password = "..."
          - pattern: PASSWORD = "..."
          - pattern: api_key = "..."
          - pattern: API_KEY = "..."
          - pattern: secret = "..."
          - pattern: SECRET = "..."
    message: 'Potential hardcoded credential detected'
    languages: [python, typescript, javascript]
    severity: ERROR

  - id: sql-injection-risk
    patterns:
      - pattern: |
          $QUERY = f"... {$VAR} ..."
          ...
          $DB.execute($QUERY)
    message: 'Potential SQL injection via f-string'
    languages: [python]
    severity: ERROR

  - id: shell-injection
    patterns:
      - pattern-either:
          - pattern: subprocess.call($CMD, shell=True, ...)
          - pattern: subprocess.run($CMD, shell=True, ...)
          - pattern: os.system($CMD)
    message: 'Potential shell injection vulnerability'
    languages: [python]
    severity: ERROR
