# Home Security Intelligence - Environment Configuration
# Copy this file to .env and adjust values as needed.
# See docs/RUNTIME_CONFIG.md for detailed documentation.

# =============================================================================
# DATABASE
# =============================================================================
# PostgreSQL async database URL (asyncpg driver)
# Native: postgresql+asyncpg://postgres:postgres@localhost:5432/security
# Docker: postgresql+asyncpg://postgres:postgres@postgres:5432/security
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/security

# =============================================================================
# REDIS
# =============================================================================
# Redis connection URL
# Native: redis://localhost:6379/0
# Docker: redis://redis:6379
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# AI SERVICES (run natively on host for GPU access)
# =============================================================================
# RT-DETRv2 object detection service
# WARNING: Use HTTPS in production to prevent man-in-the-middle (MITM) attacks.
#          HTTP is acceptable for local development only.
# Local dev: http://localhost:8090
# Production: https://your-rtdetr-host:8090
# Docker (macOS/Windows): http://host.docker.internal:8090
# Docker (Linux): http://<host-ip>:8090 or use extra_hosts
RTDETR_URL=http://localhost:8090

# Nemotron LLM risk analysis service (via llama.cpp)
# WARNING: Use HTTPS in production to prevent man-in-the-middle (MITM) attacks.
#          HTTP is acceptable for local development only.
# Local dev: http://localhost:8091
# Production: https://your-nemotron-host:8091
# Docker (macOS/Windows): http://host.docker.internal:8091
# Docker (Linux): http://<host-ip>:8091 or use extra_hosts
NEMOTRON_URL=http://localhost:8091

# =============================================================================
# CAMERA INTEGRATION
# =============================================================================
# Base directory for Foscam FTP uploads
# Cameras upload to {FOSCAM_BASE_PATH}/{camera_name}/
FOSCAM_BASE_PATH=/export/foscam

# =============================================================================
# FILE WATCHER
# =============================================================================
# Use polling observer instead of native filesystem events.
# Set to true for Docker Desktop on macOS/Windows where inotify/FSEvents
# don't propagate through volume mounts.
# Native observers (inotify/FSEvents) are more efficient but don't work
# reliably across Docker volume boundaries.
FILE_WATCHER_POLLING=false

# Polling interval in seconds when FILE_WATCHER_POLLING=true (0.1-30.0)
# Lower values = faster detection but higher CPU usage
# Higher values = lower CPU but slower detection
FILE_WATCHER_POLLING_INTERVAL=1.0

# =============================================================================
# DETECTION SETTINGS
# =============================================================================
# Minimum confidence threshold for object detections (0.0-1.0)
DETECTION_CONFIDENCE_THRESHOLD=0.5

# =============================================================================
# FAST PATH SETTINGS
# =============================================================================
# High-confidence detections bypass batching for immediate alerts
# Confidence threshold for fast path (0.0-1.0)
FAST_PATH_CONFIDENCE_THRESHOLD=0.90

# Object types eligible for fast path (JSON array)
# FAST_PATH_OBJECT_TYPES=["person"]

# =============================================================================
# BATCH PROCESSING
# =============================================================================
# Maximum time window for grouping detections into events (seconds)
BATCH_WINDOW_SECONDS=90

# Close batch after this many seconds of inactivity
BATCH_IDLE_TIMEOUT_SECONDS=30

# =============================================================================
# RETENTION
# =============================================================================
# Days to keep events and detections
RETENTION_DAYS=30

# Days to keep log entries in database
LOG_RETENTION_DAYS=7

# =============================================================================
# GPU MONITORING
# =============================================================================
# How often to poll GPU stats via pynvml (seconds, 1.0-60.0)
# Each poll reads GPU utilization, VRAM, temperature, and power usage,
# then writes to the database and broadcasts via WebSocket.
#
# Performance impact considerations:
#   1-2s   = Real-time visibility (development/debugging)
#   5s     = Balanced responsiveness and overhead (default)
#   15-30s = Lower overhead when system is under pressure
#   60s    = Minimal monitoring for trend analysis only
#
# Increase this value if:
#   - System is under heavy CPU/disk I/O pressure
#   - AI inference pipeline is saturating GPU bandwidth
#   - Database is on slow storage (HDD, network mount)
GPU_POLL_INTERVAL_SECONDS=5.0

# Minutes of GPU history to retain in memory (1-1440)
GPU_STATS_HISTORY_MINUTES=60

# =============================================================================
# FILE DEDUPLICATION
# =============================================================================
# TTL for file deduplication entries in Redis (seconds, 60-3600)
DEDUPE_TTL_SECONDS=300

# =============================================================================
# LOGGING
# =============================================================================
# Logging level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Path for rotating log file
LOG_FILE_PATH=data/logs/security.log

# Maximum size of each log file in bytes (default: 10MB)
LOG_FILE_MAX_BYTES=10485760

# Number of backup log files to keep
LOG_FILE_BACKUP_COUNT=7

# Write logs to database
LOG_DB_ENABLED=true

# Minimum log level for database logging
LOG_DB_MIN_LEVEL=DEBUG

# =============================================================================
# APPLICATION
# =============================================================================
# Enable debug mode (development only)
DEBUG=false

# API server bind address
API_HOST=0.0.0.0

# API server port
API_PORT=8000

# =============================================================================
# AUTHENTICATION (disabled by default for single-user deployment)
# =============================================================================
# Enable API key authentication
API_KEY_ENABLED=false

# Valid API keys (JSON array, hashed on startup)
# API_KEYS=["your-secure-api-key-here"]

# =============================================================================
# CORS
# =============================================================================
# Allowed origins (JSON array)
# CORS_ORIGINS=["http://localhost:3000", "http://localhost:5173"]

# =============================================================================
# FRONTEND (VITE_* vars are embedded at build time)
# =============================================================================
# Backend API URL (accessed from browser, not container)
VITE_API_BASE_URL=http://localhost:8000

# WebSocket URL (accessed from browser, not container)
VITE_WS_BASE_URL=ws://localhost:8000
