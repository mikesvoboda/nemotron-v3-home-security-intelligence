# Trivy ignore file for false positives and accepted risks
# Documentation: https://aquasecurity.github.io/trivy/latest/docs/configuration/filtering/
#
# CVE EXPIRATION TRACKING
# =======================
# Each CVE entry must include a REVIEW BY date in the comment format:
#   # CVE-XXXX-YYYY - Description (REVIEW BY: YYYY-MM-DD)
#
# A CI check validates that no CVE review dates have expired.
# See scripts/check-trivyignore-expiry.sh for the validation script.
#
# Review guidelines:
# - New CVEs: Set review date 3-6 months from date of addition
# - On review: Check if fix is available, reassess risk, extend or remove
# - Remove entries when fixes become available

# =============================================================================
# Jinja2 Sandbox Escape Vulnerabilities
# =============================================================================
# These CVEs relate to Jinja2's sandbox mode which this application does not use.
# We use Jinja2 only via FastAPI's template rendering with trusted templates.
# The sandboxed environment bypass is not exploitable in our use case.

# CVE-2024-56326 - Jinja2 sandbox escape via str.format (REVIEW BY: 2026-04-05)
# Requires attacker to control template content
# Not applicable: We don't use sandboxed environment and don't allow user-controlled templates
CVE-2024-56326

# CVE-2024-22195 - Jinja2 XSS vulnerability in xmlattr filter (REVIEW BY: 2026-04-05)
# Not applicable: We use Jinja2 for backend templates only, not user-facing HTML
CVE-2024-22195

# CVE-2025-27516 - Jinja2 sandbox breakout through attr filter (REVIEW BY: 2026-04-05)
# Not applicable: Same reasoning as CVE-2024-56326 - we don't use sandbox mode
CVE-2025-27516

# =============================================================================
# Cryptography Library - No Fix Available
# =============================================================================
# Some cryptography CVEs may appear even with the latest version because:
# 1. The fix is pending upstream OpenSSL changes
# 2. The vulnerability is in rarely-used functionality
# Add specific CVEs here if they have no fix and are accepted risk

# =============================================================================
# Python Dependencies
# =============================================================================

# CVE-2026-0994 - protobuf JSON recursion depth bypass (REVIEW BY: 2026-04-23)
# HIGH severity DoS via deeply nested JSON messages
# Not applicable: We use protobuf for internal gRPC communication only
# No user-controlled JSON deserialization to protobuf occurs in our system
CVE-2026-0994

# =============================================================================
# Alpine Linux Base Image
# =============================================================================
# Alpine-specific CVEs that are false positives or have no fix
# These often relate to packages not installed in our production image

# CVE-2024-58251 - BusyBox vulnerability affecting busybox-binsh and ssl_client (REVIEW BY: 2026-04-05)
# Low severity, no fix available in current Alpine stable
CVE-2024-58251

# CVE-2025-46394 - BusyBox vulnerability affecting busybox-binsh (REVIEW BY: 2026-04-05)
# Low severity, no fix available in current Alpine stable
CVE-2025-46394

# =============================================================================
# Debian/Ubuntu Base Image - No Fix Available
# =============================================================================
# These CVEs are in system packages with no upstream fix available

# CVE-2025-2176 - libzvbi critical vulnerability (REVIEW BY: 2026-05-05)
# No fix available in Debian stable
# Affects libzvbi0 package used by ffmpeg dependencies
CVE-2025-2176

# CVE-2023-45853 - zlib integer overflow (REVIEW BY: 2026-06-05)
# Marked "will_not_fix" by Debian
# Affects minizip functionality in zipOpenNewFileInZip4_6, not used by application
CVE-2023-45853

# CVE-2023-6879 - libaom heap-buffer-overflow CRITICAL (REVIEW BY: 2026-05-05)
# No fix in Debian stable
# Affects AV1 codec library used by ffmpeg, not directly used by application
CVE-2023-6879

# CVE-2023-39616 - libaom invalid read (REVIEW BY: 2026-06-05)
# Marked "will_not_fix" by Debian
# Same package as above, AV1 codec not directly used
CVE-2023-39616

# CVE-2023-45221 - libmfx improper buffer restrictions (REVIEW BY: 2026-06-05)
# Marked "will_not_fix" by Debian
# Intel Media SDK not used by our application
CVE-2023-45221

# CVE-2023-52355 - libtiff heap buffer overflow (REVIEW BY: 2026-05-05)
# Affected status
# TIFF processing handled by PIL with memory safety measures
CVE-2023-52355

# CVE-2023-25193 - libharfbuzz O(n^2) complexity (REVIEW BY: 2026-06-05)
# No fix available
# Text shaping library, DoS risk only in malicious font processing
CVE-2023-25193

# CVE-2024-23775 - libmbedcrypto integer overflow (REVIEW BY: 2026-05-05)
# No fix in Debian stable
# Used by some Python SSL, but not critical path
CVE-2024-23775

# CVE-2025-47917 - libmbedcrypto use-after-free CRITICAL (REVIEW BY: 2026-04-05)
# No fix in Debian stable
# Mbed TLS library used by librist (RIST protocol), ffmpeg dependency
CVE-2025-47917

# CVE-2025-48965 - libmbedcrypto NULL pointer dereference (REVIEW BY: 2026-05-05)
# No fix in Debian stable
# Mbed TLS library used by librist (RIST protocol), ffmpeg dependency
CVE-2025-48965

# CVE-2025-52496 - libmbedcrypto AESNI race condition (REVIEW BY: 2026-05-05)
# No fix in Debian stable
# Mbed TLS library used by librist (RIST protocol), ffmpeg dependency
CVE-2025-52496

# CVE-2025-13601 - libglib2.0 integer overflow in g_escape_uri_string (REVIEW BY: 2026-05-05)
# Affected status
# GLib utility function, not directly exploitable in our context
CVE-2025-13601

# CVE-2025-68973 - gpgv information disclosure/code execution (REVIEW BY: 2026-05-05)
# Affected status
# Used for apt signature verification, not user-exposed
CVE-2025-68973

# CVE-2025-7345 - libgdk-pixbuf heap buffer overflow (REVIEW BY: 2026-05-05)
# Fix deferred status
# Image processing library, input validation handles malicious images
CVE-2025-7345

# CVE-2025-7458 - libsqlite3-0 integer overflow CRITICAL (REVIEW BY: 2026-04-05)
# No fix in Debian stable
# SQLite vulnerability, affects libsqlite3-0 package used by Python stdlib
CVE-2025-7458

# CVE-2025-2173 - libzvbi vulnerability (REVIEW BY: 2026-05-05)
# Affected, no fix available in Debian stable
# Affects libzvbi0/libzvbi-common used by ffmpeg, not directly used by application
CVE-2025-2173

# CVE-2025-2174 - libzvbi vulnerability (REVIEW BY: 2026-05-05)
# Affected, no fix available in Debian stable
# Affects libzvbi0/libzvbi-common used by ffmpeg, not directly used by application
CVE-2025-2174

# CVE-2025-5318 - libssh-gcrypt out-of-bounds read in sftp_handle() (REVIEW BY: 2026-05-05)
# Affected, no fix available
# SSH library used by ffmpeg libavformat, not directly used by application
CVE-2025-5318

# CVE-2025-5372 - libssh-gcrypt incorrect return code handling in ssh_kdf() (REVIEW BY: 2026-05-05)
# Affected, no fix available
# SSH library used by ffmpeg libavformat, not directly used by application
CVE-2025-5372

# CVE-2025-5987 - libssh-gcrypt invalid return code for chacha20 poly1305 (REVIEW BY: 2026-05-05)
# Affected, no fix available
# SSH library used by ffmpeg libavformat, not directly used by application
CVE-2025-5987

# CVE-2025-6020 - libpam directory traversal (REVIEW BY: 2026-05-05)
# Affected, no fix available in Debian stable
# PAM modules used for system authentication, not user-exposed in container
CVE-2025-6020

# CVE-2026-0861 - glibc integer overflow in memalign (REVIEW BY: 2026-04-17)
# CRITICAL per Trivy, but Debian marks as "Minor issue" with <no-dsa>
# Affects libc-bin and libc6 (glibc 2.36-9+deb12u13)
# Fixed only in sid (2.42-8), not available for bookworm stable
# Exploitation requires attacker control of BOTH size (near PTRDIFF_MAX) and
# alignment (range [1<<62+1, 1<<63]) arguments to memalign/posix_memalign/aligned_alloc
# Our application doesn't expose memory allocation controls to untrusted input
# Reference: https://security-tracker.debian.org/tracker/CVE-2026-0861
CVE-2026-0861

# CVE-2023-2953 - OpenLDAP null pointer dereference in ber_memalloc_x (REVIEW BY: 2026-04-21)
# HIGH severity, no fix available in Debian bookworm stable (version 2.5.13+dfsg-5)
# Affects libldap-2.5-0 package, a transitive dependency of curl (via libcurl4)
# Not exploitable in our context:
#   1. Our application does not use LDAP functionality
#   2. libldap is only included as a dependency of curl, used for health checks
#   3. The vulnerability requires LDAP operations to trigger
# Reference: https://security-tracker.debian.org/tracker/CVE-2023-2953
CVE-2023-2953

# CVE-2026-22695 - libpng denial of service and information disclosure (REVIEW BY: 2026-04-23)
# HIGH severity, no fix available in Debian bookworm stable (version 1.6.39-2+deb12u1)
# Affects libpng16-16 package used by image processing libraries (PIL/Pillow)
# Mitigated by:
#   1. Application validates image input sizes before processing
#   2. Image processing happens in controlled pipeline with trusted FTP sources
#   3. Memory limits enforced at container level
CVE-2026-22695

# CVE-2026-22801 - libpng information disclosure and denial of service (REVIEW BY: 2026-04-23)
# HIGH severity, no fix available in Debian bookworm stable (version 1.6.39-2+deb12u1)
# Same package and mitigation as CVE-2026-22695
CVE-2026-22801

# =============================================================================
# Python Package Vulnerabilities - No Fix Available
# =============================================================================

# GHSA-58pv-8j8x-9vj2 / CVE-2026-23949 - jaraco.context path traversal in tarfile.chdir() (REVIEW BY: 2026-04-13)
# Affected version 5.3.0 is vendored inside setuptools (even latest 80.9.0)
# No upstream fix available - setuptools has not updated vendored jaraco.context to 6.1.0
# Not exploitable in our context:
#   1. We don't use jaraco.context directly
#   2. We don't use setuptools.tarfile.chdir() functionality
#   3. The vulnerability requires attacker-controlled tar extraction paths
#   4. This is a build/setup-time dependency, not runtime-exposed
GHSA-58pv-8j8x-9vj2
# CVE-2026-23949 - jaraco.context path traversal (same as GHSA-58pv-8j8x-9vj2) (REVIEW BY: 2026-04-13)
CVE-2026-23949

# CVE-2026-24049 - wheel privilege escalation/arbitrary code execution (REVIEW BY: 2026-04-23)
# Affected version 0.45.1 is vendored inside setuptools (even latest 80.9.0)
# No upstream fix available - setuptools has not updated vendored wheel to 0.46.2
# Not exploitable in our context:
#   1. We don't use wheel directly at runtime
#   2. Wheel is only used during package build/install (setuptools vendored copy)
#   3. The application does not build/install packages at runtime
#   4. Build process runs in controlled CI environment with trusted inputs
CVE-2026-24049

# CVE-2026-0994 - protobuf JSON recursion depth bypass (REVIEW BY: 2026-04-23)
# HIGH severity, no fix available for protobuf 6.33.2
# Not exploitable in our context:
#   1. We don't parse untrusted JSON with protobuf
#   2. Protobuf is used for internal serialization between AI services
#   3. All protobuf inputs come from trusted internal services (RT-DETR, Nemotron)
#   4. The vulnerability requires attacker-controlled deeply nested JSON
# Reference: https://avd.aquasec.com/nvd/cve-2026-0994
CVE-2026-0994

# CVE-2026-0994 - protobuf JSON recursion depth bypass (REVIEW BY: 2026-04-23)
# HIGH severity, no fix available yet (protobuf 6.33.2)
# Affects nested JSON parsing with deeply recursive structures
# Not exploitable in our context:
#   1. We don't expose protobuf JSON parsing to untrusted input
#   2. Used only for internal gRPC communication with AI services
#   3. Input validation at API layer prevents malicious payloads
CVE-2026-0994

# =============================================================================
# Dockerfile Misconfigurations - Accepted Risks
# =============================================================================
# These are Trivy misconfiguration checks that are intentionally accepted.

# AVD-DS-0002 - vsftpd requires root to bind to privileged port 21 (REVIEW BY: 2026-07-05)
# vsftpd is an FTP server that needs root privileges to:
# 1. Bind to port 21 (privileged port)
# 2. Create system users via useradd/chpasswd in entrypoint
# 3. Manage FTP user sessions
# The service is isolated in its own container with limited network exposure.
AVD-DS-0002

# =============================================================================
# Notes
# =============================================================================
# Before adding a CVE here, verify:
# 1. No fix is available, OR
# 2. The vulnerability is not exploitable in our deployment context, OR
# 3. The risk is accepted after security review
#
# Remove entries when fixes become available.
#
# Last reviewed: 2026-01-23 (NEM-3342)
# Next review: 2026-04-23
